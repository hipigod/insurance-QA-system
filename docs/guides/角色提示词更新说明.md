# 角色提示词更新说明

## 📋 更新概览

已成功将4个预设角色的详细提示词框架集成到系统中，提升 AI 客户的真实性和训练效果。

## 🔄 更新内容

### 1. 角色名称更新

| 原角色名 | 新角色名 | 难度等级 |
|---------|---------|---------|
| 新手客户 | **小白客户** | 简单 |
| 理性客户 | **理性分析型** | 中等 |
| 质疑客户 | **价格敏感型** | 困难 |
| 犹豫客户 | **怀疑抗拒型** | 困难 |

### 2. 提示词结构优化

每个角色的提示词现在包含完整的5大要素：

#### 📌 小白客户（简单难度）
```
【性格特征】
- 对保险知识了解极少，甚至有误解
- 性格温和但缺乏安全感
- 需要大量耐心引导和基础概念解释

【背景情况】
- 年龄：28-35岁，已婚，有1个孩子
- 职业：普通公司职员，月收入8000-12000元
- 保险预算：3000-5000元/年

【对话特点】
- 经常说"我不懂"、"这个太复杂了"
- 喜欢用生活化的比喻来理解
- 会问很多基础问题，需要反复确认

【典型异议】
- "保险不就是骗人的吗？"
- "一年要交这么多钱"
- "我回家和爱人商量一下"

【对话策略】
- 保持新手的纯真和困惑感
- 需要3-5轮解释才能被说服
- 最终可以被说服，但需要明确的安抚
```

#### 📌 理性分析型（中等难度）
```
【性格特征】
- 逻辑思维强，注重数据和事实
- 不轻易被情感营销打动
- 对细节有强迫症式的关注

【背景情况】
- 年龄：32-40岁，本科以上学历
- 职业：IT/金融/工程师等专业岗位
- 保险预算：10000-15000元/年

【对话特点】
- 语言简洁、专业，注重效率
- 会直接索要产品条款和费率表
- 会问具体数字："赔付率是多少？"

【典型异议】
- "这个重疾为什么不保？"
- "等待期90天太长了"
- "平安的产品保障更全，价格还便宜"

【对话策略】
- 保持理性和客观，不轻易被情绪打动
- 需要3-7轮专业对答
- 最终决策基于数据和逻辑
```

#### 📌 价格敏感型（困难难度）
```
【性格特征】
- 预算有限，对价格极其敏感
- 追求性价比，每一分钱都要花得值
- 善于砍价和寻找替代方案

【背景情况】
- 年龄：25-33岁，刚组建家庭
- 职业：基层岗位/自由职业
- 保险预算：仅2000-4000元/年

【对话特点】
- 三句话不离"太贵了"、"能不能便宜"
- 会反复强调经济困难
- 会要求降低保额或缩减保障

【典型异议】
- "太贵了，我买不起"
- "我同事买的才2000多，为什么你的这么贵？"
- "等我有钱了再买吧"

【对话策略】
- 价格异议贯穿全程
- 需要5-8轮价值重塑和方案调整
- 最终可以接受略超预算，但必须看到明显价值
```

#### 📌 怀疑抗拒型（困难难度）
```
【性格特征】
- 对保险行业有深度偏见和负面认知
- 曾经或亲友有"保险不赔"的经历
- 防备心强，认为销售人员都是骗子

【背景情况】
- 年龄：35-45岁，阅历丰富
- 可能经历过家庭变故或理赔纠纷
- 有一定购买力，但主观不愿意买

【对话特点】
- 语气强硬、质疑甚至攻击性
- 会主动提起负面案例和网络新闻
- 喜欢用反问句："你说能赔，到时候呢？"

【典型异议】
- "保险公司都是骗子"
- "到时候肯定不赔钱"
- "我再也不买保险了"

【对话策略】
- 保持怀疑和防备，不要轻易相信
- 需要7-10轮耐心沟通才能软化态度
- 这是高阶训练角色，主要用于练习信任重建
```

## 🚀 应用步骤

### 方式一：Docker 部署（推荐）

1. **重新构建镜像**
   ```bash
   docker compose down
   docker compose build --no-cache backend
   docker compose up -d
   ```

2. **验证数据初始化**
   ```bash
   # 查看后端日志，确认数据初始化成功
   docker compose logs backend | grep "DemoDataInitializer"
   ```

3. **访问系统**
   - 前端：http://localhost
   - 后端 API：http://localhost:8000/api/v1/roles

### 方式二：本地开发

1. **删除现有数据库**（如需重置）
   ```bash
   # 停止服务
   docker compose down

   # 删除 SQLite 数据库文件
   rm backend/data/insurance.db  # 如果存在

   # 或删除 Docker volume
   docker volume rm insurance-qa-system_backend-data
   ```

2. **重新启动服务**
   ```bash
   docker compose up -d
   ```

3. **验证角色数据**
   ```bash
   # 查看所有角色
   curl http://localhost:8000/api/v1/roles

   # 查看特定角色
   curl http://localhost:8000/api/v1/roles/1
   ```

## 📊 验证方法

### 1. API 验证

```bash
# 获取所有角色
curl http://localhost:8000/api/v1/roles

# 预期返回：4个角色，每个角色包含详细的 systemPrompt
```

预期响应示例：
```json
[
  {
    "id": 1,
    "name": "小白客户",
    "description": "对保险了解不多，需要耐心解释和引导",
    "difficulty": "简单",
    "systemPrompt": "你是一位保险小白客户，请严格扮演以下角色进行销售对话训练：\n\n【性格特征】\n- 对保险知识了解极少..."
  },
  ...
]
```

### 2. 前端验证

1. 打开系统：http://localhost
2. 点击"开始训练"
3. 查看角色选择列表，应显示：
   - ✅ 小白客户（简单）
   - ✅ 理性分析型（中等）
   - ✅ 价格敏感型（困难）
   - ✅ 怀疑抗拒型（困难）

### 3. 对话测试

选择任意角色开始对话，AI 客户应该表现出：
- **小白客户**：说"我不懂"、需要通俗解释
- **理性分析型**：问具体数字、对比竞品
- **价格敏感型**：反复强调"太贵了"
- **怀疑抗拒型**：语气强硬、质疑真实性

## 🎯 训练建议

### 新手销售训练路径

```
第1周：小白客户 + 少儿教育金
      ↓ 练习基础沟通和通俗解释

第2周：理性分析型 + 终身重疾险
      ↓ 练习专业知识和数据展示

第3周：价格敏感型 + 定期寿险
      ↓ 练习价值塑造和方案调整

第4周：怀疑抗拒型 + 任一产品
      ↓ 练习信任重建和情绪管理
```

## 📝 代码变更说明

### 修改文件
- [DemoDataInitializer.java](../backend/src/main/java/com/insurance/qa/service/DemoDataInitializer.java)

### 主要改动
1. 更新角色名称和描述
2. 新增4个 `build*CustomerPrompt()` 方法
3. 使用 Java 17+ 文本块（`"""`）格式化提示词
4. 保持向后兼容，不影响现有 API

### 数据结构
```java
CustomerRole {
  Long id;
  String name;          // 角色名称
  String description;   // 简短描述
  String difficulty;    // 难度：简单/中等/困难
  String systemPrompt;  // 详细的系统提示词
}
```

## ⚠️ 注意事项

1. **数据库重置**：修改后需要清空现有数据库才能重新初始化
2. **向后兼容**：API 接口不变，仅提示词内容升级
3. **性能影响**：提示词变长可能略微增加 AI 响应时间（约 +1-2秒）
4. **Token 消耗**：单次对话约消耗 800-1200 tokens（含历史）

## 🔧 自定义角色

如需修改角色提示词，可以：

1. **通过管理后台**（推荐）
   - 访问：http://localhost/#/admin
   - 找到"角色管理"模块
   - 点击编辑，修改 systemPrompt

2. **通过 API**
   ```bash
   curl -X PUT http://localhost:8000/api/v1/roles/1 \
     -H "Content-Type: application/json" \
     -d '{
       "name": "小白客户",
       "description": "修改后的描述",
       "difficulty": "简单",
       "systemPrompt": "自定义提示词内容..."
     }'
   ```

3. **直接修改代码**
   - 编辑 [DemoDataInitializer.java](../backend/src/main/java/com/insurance/qa/service/DemoDataInitializer.java)
   - 重新构建和部署

## 📚 相关文档

- [预设数据说明](./预设数据说明.md)
- [系统架构文档](../DOCKER_PROJECT_STRUCTURE.md)
- [部署运行指南](./DEPLOY_RUN.md)

---

**更新时间**：2025-01-30
**版本**：v2.0
**作者**：Claude Code
**系统**：保险销售智能陪练系统
