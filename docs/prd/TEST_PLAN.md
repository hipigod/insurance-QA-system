# 测试计划与测试用例 V2.0

**项目名称**: 保险销售智能陪练系统 Demo V1.2
**测试日期**: 2025-12-30
**测试目标**: 验证核心功能完整性、Bug修复效果及代码重构后的稳定性

**更新内容**:
- ✅ Bug#1修复验证: 评分维度从数据库读取
- ✅ Bug#2新增功能: 模型配置管理
- ✅ Admin.vue重构验证: 组件化改造

---

## 📋 测试范围

### 1. 后端API测试
- [ ] 角色管理API (增删改查)
- [ ] 产品管理API (增删改查)
- [ ] 评分维度管理API (增删改查)
- [ ] 优秀案例管理API (增删改查)
- [ ] **模型配置管理API (增删改查)** ⭐ 新增
- [ ] 对话启动API
- [ ] 对话评分API

### 2. 前端功能测试
- [ ] 首页加载
- [ ] 场景选择(角色+产品)
- [ ] 管理后台入口
- [ ] 管理后台 - 角色管理(组件化)
- [ ] 管理后台 - 产品管理(组件化)
- [ ] 管理后台 - 评分维度管理
- [ ] 管理后台 - 案例管理
- [ ] **管理后台 - 模型配置管理** ⭐ 新增
- [ ] 管理后台 - 数据导出(组件化)

### 3. WebSocket实时对话测试
- [ ] 连接建立
- [ ] AI首次问候
- [ ] 多轮对话
- [ ] 异常处理
- [ ] 对话结束

### 4. AI评分功能测试 ⭐ 重点测试Bug#1修复
- [ ] **评分维度从数据库动态读取** ⭐ 新增验证
- [ ] 评分请求成功
- [ ] 评分结果格式正确
- [ ] **显示正确的维度名称** (需求挖掘、产品说明、异议处理、促成能力)
- [ ] 异议识别
- [ ] 总分计算

### 5. 集成测试
- [ ] 完整用户流程(选择→对话→评分→查看历史)
- [ ] 数据持久化
- [ ] 数据导入导出
- [ ] **模型切换功能** ⭐ 新增

### 6. 代码质量测试 ⭐ 新增
- [ ] 组件独立性验证
- [ ] 组件间通信测试
- [ ] 热更新功能测试

---

## 🧪 详细测试用例

### TC001: 后端启动测试

**测试步骤**:
1. 激活虚拟环境
2. 运行 `python main.py`
3. 检查输出信息

**预期结果**:
```
保险销售智能陪练系统 v1.2.0 启动成功！
API地址: http://127.0.0.1:8000/docs
INFO:     Uvicorn running on http://127.0.0.1:8000
```

**实际结果**: ______________

**状态**: ✅ PASS / ❌ FAIL

---

### TC002: 数据库初始化测试

**测试步骤**:
1. 运行 `python scripts/init_preset_data.py`
2. 检查输出信息

**预期结果**:
```
初始化完成！
   - 客户角色: 4 个
   - 保险产品: 3 个
   - 评分维度: 4 个
   - AI模型: 1 个 (通义千问)
```

**实际结果**: ______________

**状态**: ✅ PASS / ❌ FAIL

---

### TC003: 角色API测试

**测试步骤**:
1. 访问 http://127.0.0.1:8000/docs
2. 测试 GET /api/roles/
3. 验证返回4个角色

**预期结果**:
```json
[
  {"id": 1, "name": "小白客户", "difficulty": "简单"},
  {"id": 2, "name": "懂行客户", "difficulty": "困难"},
  {"id": 3, "name": "难缠客户", "difficulty": "专家"},
  {"id": 4, "name": "犹豫客户", "difficulty": "普通"}
]
```

**实际结果**: ______________

**状态**: ✅ PASS / ❌ FAIL

---

### TC004: 产品API测试

**测试步骤**:
1. 测试 GET /api/products/
2. 验证返回3个产品

**预期结果**:
```json
[
  {"id": 1, "name": "重疾险无忧版"},
  {"id": 2, "name": "百万医疗险"},
  {"id": 3, "name": "定期寿险"}
]
```

**实际结果**: ______________

**状态**: ✅ PASS / ❌ FAIL

---

### TC005: 前端启动测试

**测试步骤**:
1. cd frontend
2. npm run dev
3. 访问 http://localhost:5174

**预期结果**:
- 页面正常加载
- 显示标题"保险销售智能陪练系统"
- 显示角色和产品列表

**实际结果**: ______________

**状态**: ✅ PASS / ❌ FAIL

---

### TC006: 场景选择功能测试

**测试步骤**:
1. 选择"小白客户"角色
2. 选择"重疾险无忧版"产品
3. 点击"开始对话练习"

**预期结果**:
- 按钮状态变为可点击
- 跳转到对话页面
- 显示AI首次问候

**实际结果**: ______________

**状态**: ✅ PASS / ❌ FAIL

---

### TC007: WebSocket连接测试

**测试步骤**:
1. 进入对话页面
2. 打开浏览器控制台(F12)
3. 查看WebSocket连接状态

**预期结果**:
- 控制台显示"WebSocket连接成功"
- 无错误信息

**实际结果**: ______________

**状态**: ✅ PASS / ❌ FAIL

---

### TC008: AI对话功能测试

**测试步骤**:
1. 在对话框输入"你好,我想了解一下保险"
2. 点击"发送"
3. 观察AI回复

**预期结果**:
- 显示"AI正在输入..."状态
- 5秒内收到AI回复
- AI回复符合角色特征
- 对话历史正确显示

**实际结果**: ______________

**状态**: ✅ PASS / ❌ FAIL

---

### TC009: **AI评分功能测试 - Bug#1修复验证** ⭐ 重点

**测试步骤**:
1. 进行至少3轮对话
2. 点击"结束对话"
3. 等待评分完成
4. **检查评分维度名称**

**预期结果**:
- 显示"正在评分..."状态
- 10秒内收到评分结果
- 评分结果包含:
  - 总分(0-100)
  - **正确的维度名称**:
    - 需求挖掘 (25%)
    - 产品说明 (25%)
    - 异议处理 (25%)
    - 促成能力 (25%)
  - 异议类型标签
  - 总体评价
- **❌ 不应该显示**旧维度(沟通能力、有效营销等)

**实际结果**: ______________

**状态**: ✅ PASS / ❌ FAIL

**Bug#1修复验证**: ✅ 通过 / ❌ 未通过

---

### TC010: **模型配置管理功能测试 - Bug#2新增功能** ⭐ 新增

**测试步骤**:
1. 访问管理后台
2. 点击"模型配置管理"Tab页
3. 查看模型列表
4. 验证通义千问模型存在

**预期结果**:
- Tab页标题: "模型配置管理"
- 显示模型列表,包含:
  - ID: 1
  - 模型名称: qwen-plus
  - 提供商: 通义千问
  - API地址: https://dashscope.aliyuncs.com/compatible-mode/v1
  - 状态: 启用(绿色标签)
- 显示3个操作按钮: 编辑、启用/禁用、删除

**实际结果**: ______________

**状态**: ✅ PASS / ❌ FAIL

---

### TC011: **模型新增功能测试** ⭐ 新增

**测试步骤**:
1. 点击"新增模型"按钮
2. 填写以下信息:
   - 模型名称: "测试模型"
   - 提供商: "测试提供商"
   - API Key: "sk-test123"
   - API地址: "https://test.example.com/v1"
   - 状态: 启用
3. 点击"保存"

**预期结果**:
- 显示模型配置对话框
- 表单字段齐全
- 显示"创建成功"提示
- 新模型出现在列表中
- API成功返回模型列表

**实际结果**: ______________

**状态**: ✅ PASS / ❌ FAIL

---

### TC012: **模型编辑功能测试** ⭐ 新增

**测试步骤**:
1. 点击"通义千问"模型的"编辑"按钮
2. 修改提供商为"阿里云(测试)"
3. 点击"保存"

**预期结果**:
- 对话框预填充现有数据
- 显示"更新成功"提示
- 模型信息更新
- 列表刷新显示新数据

**实际结果**: ______________

**状态**: ✅ PASS / ❌ FAIL

---

### TC013: **模型启用/禁用切换测试** ⭐ 新增

**测试步骤**:
1. 找到一个启用的模型
2. 点击"禁用"按钮
3. 观察状态变化
4. 再次点击"启用"

**预期结果**:
- 第一次点击: 状态变为"禁用"(灰色标签)
- 按钮文字变为"启用"
- 显示"已禁用"提示
- 第二次点击: 状态恢复为"启用"(绿色标签)
- 显示"已启用"提示

**实际结果**: ______________

**状态**: ✅ PASS / ❌ FAIL

---

### TC014: **模型删除功能测试** ⭐ 新增

**测试步骤**:
1. 创建一个测试模型(如果还没有)
2. 点击该模型的"删除"按钮
3. 确认删除

**预期结果**:
- 显示确认对话框"确定要删除这个模型配置吗?"
- 确认后显示"删除成功"
- 模型从列表中移除
- API返回成功

**实际结果**: ______________

**状态**: ✅ PASS / ❌ FAIL

---

### TC015: 管理后台访问测试

**测试步骤**:
1. 返回首页
2. 点击"管理后台"链接

**预期结果**:
- 跳转到/admin页面
- 显示**6个**标签页 (原5个 + 1个新增):
  - 客户角色管理
  - 保险产品管理
  - 评分维度管理
  - 优秀案例库
  - **模型配置管理** ⭐ 新增
  - 数据导出

**实际结果**: ______________

**状态**: ✅ PASS / ❌ FAIL

---

### TC016: **角色管理组件测试 - Admin.vue重构验证** ⭐ 新增

**测试步骤**:
1. 进入"客户角色管理"Tab页
2. 点击"小白客户"的"编辑"按钮
3. 修改角色名称为"小白客户(测试)"
4. 点击"保存"

**预期结果**:
- 显示角色列表(组件渲染正常)
- 显示"更新成功"提示
- 角色列表更新(组件状态管理正常)
- 修改立即生效
- **无控制台错误**

**实际结果**: ______________

**状态**: ✅ PASS / ❌ FAIL

**组件独立性验证**: ✅ 通过 / ❌ 未通过

---

### TC017: **产品管理组件测试** ⭐ 新增

**测试步骤**:
1. 进入"保险产品管理"Tab页
2. 点击"新增产品"
3. 填写产品信息并保存

**预期结果**:
- 组件正常显示
- 表单验证正常
- 显示"创建成功"
- 产品列表更新
- **无控制台错误**

**实际结果**: ______________

**状态**: ✅ PASS / ❌ FAIL

---

### TC018: **数据导出组件测试** ⭐ 新增

**测试步骤**:
1. 进入"数据导出"Tab页
2. 点击"导出为JSON"
3. 检查下载的文件

**预期结果**:
- 组件正常显示
- 导出功能正常
- 浏览器下载JSON文件
- 文件格式正确

**实际结果**: ______________

**状态**: ✅ PASS / ❌ FAIL

---

### TC019: 数据导入导出功能测试

**测试步骤**:
1. 先完成一次练习并查看评分
2. 进入管理后台"数据导出"标签
3. 点击"导出为JSON"
4. 检查下载的文件

**预期结果**:
- 浏览器下载JSON文件
- 文件名格式: `practice_history_2025-12-30.json`
- 文件内容为有效JSON格式
- 包含完整的练习记录

**实际结果**: ______________

**状态**: ✅ PASS / ❌ FAIL

---

### TC020: 数据导入功能测试

**测试步骤**:
1. 清除LocalStorage: `localStorage.clear()`
2. 点击"选择JSON文件导入"
3. 选择刚才导出的JSON文件
4. 刷新页面查看历史记录

**预期结果**:
- 显示"成功导入X条记录"
- 历史记录页面显示导入的数据
- 数据完整性一致

**实际结果**: ______________

**状态**: ✅ PASS / ❌ FAIL

---

### TC021: **热更新功能测试 - Admin.vue重构验证** ⭐ 新增

**测试步骤**:
1. 打开浏览器开发者工具
2. 访问管理后台页面
3. 修改一个组件文件(如RoleManagement.vue)
4. 观察浏览器

**预期结果**:
- 控制台显示"[vite] hmr update"消息
- 页面自动刷新
- 组件更新生效
- **无需手动刷新浏览器**
- 状态保持正常

**实际结果**: ______________

**状态**: ✅ PASS / ❌ FAIL

---

### TC022: 完整用户流程测试

**测试步骤**:
1. 打开首页
2. 选择角色和产品
3. 开始对话(3-5轮)
4. 结束对话查看评分
5. **验证评分维度是否正确** ⭐ Bug#1修复验证
6. 返回首页查看历史
7. 进入管理后台
8. **测试模型配置管理** ⭐ Bug#2新增功能
9. 导出练习记录

**预期结果**:
- 所有功能正常工作
- 无报错或异常
- 数据流转正确
- 用户体验流畅
- **评分维度显示正确** (需求挖掘、产品说明、异议处理、促成能力)
- **模型配置功能正常**

**实际结果**: ______________

**状态**: ✅ PASS / ❌ FAIL

---

### TC023: 响应时间测试

**测试步骤**:
1. 测量AI对话响应时间(发送消息到收到回复)
2. 测量AI评分响应时间(结束对话到收到评分)
3. 记录实际耗时

**预期结果**:
- AI对话响应 < 5秒
- AI评分响应 < 10秒

**实际结果**:
- 对话响应: ___秒
- 评分响应: ___秒

**状态**: ✅ PASS / ❌ FAIL

---

### TC024: 异常处理测试

**测试步骤**:
1. 在未选择角色时点击开始
2. 输入空消息并尝试发送
3. 在对话中刷新页面
4. **测试删除最后一个模型的处理** ⭐ 新增

**预期结果**:
- 显示友好的错误提示
- 系统不会崩溃
- 提供恢复建议

**实际结果**: ______________

**状态**: ✅ PASS / ❌ FAIL

---

### TC025: **代码质量测试 - 组件独立性** ⭐ 新增

**测试步骤**:
1. 检查各个组件的代码
2. 验证组件职责单一性
3. 检查组件间依赖关系

**预期结果**:
- 每个组件职责单一
- 组件间低耦合
- 组件可独立测试
- 代码结构清晰

**实际结果**: ______________

**状态**: ✅ PASS / ❌ FAIL

---

## 📊 测试结果汇总

| 测试用例 | 状态 | 备注 |
|:---|:---|:---|
| TC001: 后端启动 | ⬜ | |
| TC002: 数据库初始化 | ⬜ | |
| TC003: 角色API | ⬜ | |
| TC004: 产品API | ⬜ | |
| TC005: 前端启动 | ⬜ | |
| TC006: 场景选择 | ⬜ | |
| TC007: WebSocket连接 | ⬜ | |
| TC008: AI对话 | ⬜ | |
| TC009: **AI评分-Bug#1修复** ⭐ | ⬜ | 重点测试 |
| TC010: **模型配置管理** ⭐ | ⬜ | 新增功能 |
| TC011: **模型新增** ⭐ | ⬜ | 新增功能 |
| TC012: **模型编辑** ⭐ | ⬜ | 新增功能 |
| TC013: **模型启用/禁用** ⭐ | ⬜ | 新增功能 |
| TC014: **模型删除** ⭐ | ⬜ | 新增功能 |
| TC015: 管理后台 | ⬜ | |
| TC016: **角色管理组件** ⭐ | ⬜ | 重构验证 |
| TC017: **产品管理组件** ⭐ | ⬜ | 重构验证 |
| TC018: **数据导出组件** ⭐ | ⬜ | 重构验证 |
| TC019: 数据导入导出 | ⬜ | |
| TC020: 数据导入 | ⬜ | |
| TC021: **热更新功能** ⭐ | ⬜ | 重构验证 |
| TC022: 完整流程 | ⬜ | |
| TC023: 响应时间 | ⬜ | |
| TC024: 异常处理 | ⬜ | |
| TC025: **代码质量** ⭐ | ⬜ | 重构验证 |

**总计**: __ / 25 通过

**Bug修复验证**:
- Bug#1 (评分维度): ✅ / ❌
- Bug#2 (模型配置): ✅ / ❌

**重构验证**:
- 组件化改造: ✅ / ❌
- 热更新功能: ✅ / ❌

---

## 🐛 Bug记录

| Bug ID | 严重程度 | 问题描述 | 状态 |
|:---|:---|:---|:---|
| BUG-001 | | | ⬜ 待修复 |

---

## ✅ 测试结论

**功能完整性**: ___________

**稳定性**: ___________

**用户体验**: ___________

**代码质量**: ___________ ⭐ 新增

**Bug修复效果**: ___________ ⭐ 新增

**总体评价**: ___________

**建议**:
1. ___________
2. ___________
3. ___________

---

**测试人员**: Claude AI
**审核人员**: ___________
**测试日期**: 2025-12-30
**版本**: V2.0 (包含Bug修复和重构验证)
